{"ast":null,"code":"import _defineProperty from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/src/components/Account/index.js\";\nimport React, { Component } from 'react';\nimport { compose } from 'recompose';\nimport { AuthUserContext, withAuthorization, withEmailVerification } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { PasswordForgetForm } from '../PasswordForget';\nimport PasswordChangeForm from '../PasswordChange';\nvar SIGN_IN_METHODS = [{\n  id: 'password',\n  provider: null\n}, {\n  id: 'google.com',\n  provider: 'googleProvider'\n}, {\n  id: 'facebook.com',\n  provider: 'facebookProvider' // {\n  //   id: 'twitter.com',\n  //   provider: 'twitterProvider',\n  // },\n\n}];\n\nvar AccountPage = function AccountPage() {\n  return React.createElement(AuthUserContext.Consumer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, function (authUser) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 31\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32\n      },\n      __self: this\n    }, \"Account: \", authUser.email), React.createElement(PasswordForgetForm, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33\n      },\n      __self: this\n    }), React.createElement(PasswordChangeForm, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34\n      },\n      __self: this\n    }), React.createElement(LoginManagement, {\n      authUser: authUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35\n      },\n      __self: this\n    }));\n  });\n};\n\nvar LoginManagementBase =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(LoginManagementBase, _Component);\n\n  function LoginManagementBase(props) {\n    var _this;\n\n    _classCallCheck(this, LoginManagementBase);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LoginManagementBase).call(this, props));\n\n    _this.fetchSignInMethods = function () {\n      _this.props.firebase.auth.fetchSignInMethodsForEmail(_this.props.authUser.email).then(function (activeSignInMethods) {\n        return _this.setState({\n          activeSignInMethods: activeSignInMethods,\n          error: null\n        });\n      }).catch(function (error) {\n        return _this.setState({\n          error: error\n        });\n      });\n    };\n\n    _this.onSocialLoginLink = function (provider) {\n      _this.props.firebase.auth.currentUser.linkWithPopup(_this.props.firebase[provider]).then(_this.fetchSignInMethods).catch(function (error) {\n        return _this.setState({\n          error: error\n        });\n      });\n    };\n\n    _this.onDefaultLoginLink = function (password) {\n      var credential = _this.props.firebase.emailAuthProvider.credential(_this.props.authUser.email, password);\n\n      _this.props.firebase.auth.currentUser.linkAndRetrieveDataWithCredential(credential).then(_this.fetchSignInMethods).catch(function (error) {\n        return _this.setState({\n          error: error\n        });\n      });\n    };\n\n    _this.onUnlink = function (providerId) {\n      _this.props.firebase.auth.currentUser.unlink(providerId).then(_this.fetchSignInMethods).catch(function (error) {\n        return _this.setState({\n          error: error\n        });\n      });\n    };\n\n    _this.state = {\n      activeSignInMethods: [],\n      error: null\n    };\n    return _this;\n  }\n\n  _createClass(LoginManagementBase, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchSignInMethods();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          activeSignInMethods = _this$state.activeSignInMethods,\n          error = _this$state.error;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, \"Sign In Methods:\", React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, SIGN_IN_METHODS.map(function (signInMethod) {\n        var onlyOneLeft = activeSignInMethods.length === 1;\n        var isEnabled = activeSignInMethods.includes(signInMethod.id);\n        return React.createElement(\"li\", {\n          key: signInMethod.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, signInMethod.id === 'password' ? React.createElement(DefaultLoginToggle, {\n          onlyOneLeft: onlyOneLeft,\n          isEnabled: isEnabled,\n          signInMethod: signInMethod,\n          onLink: _this2.onDefaultLoginLink,\n          onUnlink: _this2.onUnlink,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }) : React.createElement(SocialLoginToggle, {\n          onlyOneLeft: onlyOneLeft,\n          isEnabled: isEnabled,\n          signInMethod: signInMethod,\n          onLink: _this2.onSocialLoginLink,\n          onUnlink: _this2.onUnlink,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }));\n      })), error && error.message);\n    }\n  }]);\n\n  return LoginManagementBase;\n}(Component);\n\nvar SocialLoginToggle = function SocialLoginToggle(_ref) {\n  var onlyOneLeft = _ref.onlyOneLeft,\n      isEnabled = _ref.isEnabled,\n      signInMethod = _ref.signInMethod,\n      onLink = _ref.onLink,\n      onUnlink = _ref.onUnlink;\n  return isEnabled ? React.createElement(\"button\", {\n    type: \"button\",\n    onClick: function onClick() {\n      return onUnlink(signInMethod.id);\n    },\n    disabled: onlyOneLeft,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, \"Deactivate \", signInMethod.id) : React.createElement(\"button\", {\n    type: \"button\",\n    onClick: function onClick() {\n      return onLink(signInMethod.provider);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, \"Link \", signInMethod.id);\n};\n\nvar DefaultLoginToggle =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(DefaultLoginToggle, _Component2);\n\n  function DefaultLoginToggle(props) {\n    var _this3;\n\n    _classCallCheck(this, DefaultLoginToggle);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(DefaultLoginToggle).call(this, props));\n\n    _this3.onSubmit = function (event) {\n      event.preventDefault();\n\n      _this3.props.onLink(_this3.state.passwordOne);\n\n      _this3.setState({\n        passwordOne: '',\n        passwordTwo: ''\n      });\n    };\n\n    _this3.onChange = function (event) {\n      _this3.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this3.state = {\n      passwordOne: '',\n      passwordTwo: ''\n    };\n    return _this3;\n  }\n\n  _createClass(DefaultLoginToggle, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          onlyOneLeft = _this$props.onlyOneLeft,\n          isEnabled = _this$props.isEnabled,\n          signInMethod = _this$props.signInMethod,\n          onUnlink = _this$props.onUnlink;\n      var _this$state2 = this.state,\n          passwordOne = _this$state2.passwordOne,\n          passwordTwo = _this$state2.passwordTwo;\n      var isInvalid = passwordOne !== passwordTwo || passwordOne === '';\n      return;\n      isEnabled ? React.createElement(\"button\", {\n        type: \"button\",\n        onClick: function onClick() {\n          return onUnlink(signInMethod.id);\n        },\n        disabled: onlyOneLeft,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"Deactivate \", signInMethod.id) : React.createElement(\"form\", {\n        onSubmit: this.onSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        name: \"passwordOne\",\n        value: passwordOne,\n        onChange: this.onChange,\n        type: \"password\",\n        placeholder: \"New Password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        name: \"passwordTwo\",\n        value: passwordTwo,\n        onChange: this.onChange,\n        type: \"password\",\n        placeholder: \"Confirm New Password\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        disabled: isInvalid,\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"Link \", signInMethod.id));\n    }\n  }]);\n\n  return DefaultLoginToggle;\n}(Component);\n\nvar LoginManagement = withFirebase(LoginManagementBase);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default compose(withEmailVerification, withAuthorization(condition))(AccountPage);","map":{"version":3,"sources":["/Users/camilledesoubrie/Documents/applications/react-firebase-authentication/src/components/Account/index.js"],"names":["React","Component","compose","AuthUserContext","withAuthorization","withEmailVerification","withFirebase","PasswordForgetForm","PasswordChangeForm","SIGN_IN_METHODS","id","provider","AccountPage","authUser","email","LoginManagementBase","props","fetchSignInMethods","firebase","auth","fetchSignInMethodsForEmail","then","activeSignInMethods","setState","error","catch","onSocialLoginLink","currentUser","linkWithPopup","onDefaultLoginLink","password","credential","emailAuthProvider","linkAndRetrieveDataWithCredential","onUnlink","providerId","unlink","state","map","signInMethod","onlyOneLeft","length","isEnabled","includes","message","SocialLoginToggle","onLink","DefaultLoginToggle","onSubmit","event","preventDefault","passwordOne","passwordTwo","onChange","target","name","value","isInvalid","LoginManagement","condition"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { compose } from 'recompose';\n\nimport { AuthUserContext, withAuthorization, withEmailVerification } from '../Session';\nimport { withFirebase } from '../Firebase';\nimport { PasswordForgetForm } from '../PasswordForget';\nimport PasswordChangeForm from '../PasswordChange';\n\nconst SIGN_IN_METHODS = [\n\t{\n\t\tid       : 'password',\n\t\tprovider : null\n\t},\n\t{\n\t\tid       : 'google.com',\n\t\tprovider : 'googleProvider'\n\t},\n\t{\n\t\tid       : 'facebook.com',\n\t\tprovider : 'facebookProvider'\n\t}\n\t// {\n\t//   id: 'twitter.com',\n\t//   provider: 'twitterProvider',\n\t// },\n];\n\nconst AccountPage = () => (\n\t<AuthUserContext.Consumer>\n\t\t{(authUser) => (\n\t\t\t<div>\n\t\t\t\t<h1>Account: {authUser.email}</h1>\n\t\t\t\t<PasswordForgetForm />\n\t\t\t\t<PasswordChangeForm />\n\t\t\t\t<LoginManagement authUser={authUser} />\n\t\t\t</div>\n\t\t)}\n\t</AuthUserContext.Consumer>\n);\n\nclass LoginManagementBase extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactiveSignInMethods : [],\n\t\t\terror               : null\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.fetchSignInMethods();\n\t}\n\n\tfetchSignInMethods = () => {\n\t\tthis.props.firebase.auth\n\t\t\t.fetchSignInMethodsForEmail(this.props.authUser.email)\n\t\t\t.then((activeSignInMethods) => this.setState({ activeSignInMethods, error: null }))\n\t\t\t.catch((error) => this.setState({ error }));\n\t};\n\n\tonSocialLoginLink = (provider) => {\n\t\tthis.props.firebase.auth.currentUser\n\t\t\t.linkWithPopup(this.props.firebase[provider])\n\t\t\t.then(this.fetchSignInMethods)\n\t\t\t.catch((error) => this.setState({ error }));\n\t};\n\n\tonDefaultLoginLink = (password) => {\n\t\tconst credential = this.props.firebase.emailAuthProvider.credential(this.props.authUser.email, password);\n\n\t\tthis.props.firebase.auth.currentUser\n\t\t\t.linkAndRetrieveDataWithCredential(credential)\n\t\t\t.then(this.fetchSignInMethods)\n\t\t\t.catch((error) => this.setState({ error }));\n\t};\n\n\tonUnlink = (providerId) => {\n\t\tthis.props.firebase.auth.currentUser\n\t\t\t.unlink(providerId)\n\t\t\t.then(this.fetchSignInMethods)\n\t\t\t.catch((error) => this.setState({ error }));\n\t};\n\n\trender() {\n\t\tconst { activeSignInMethods, error } = this.state;\n\n\t\treturn (\n\t\t\t<div>\n\t\t\t\tSign In Methods:\n\t\t\t\t<ul>\n\t\t\t\t\t{SIGN_IN_METHODS.map((signInMethod) => {\n\t\t\t\t\t\tconst onlyOneLeft = activeSignInMethods.length === 1;\n\t\t\t\t\t\tconst isEnabled = activeSignInMethods.includes(signInMethod.id);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li key={signInMethod.id}>\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsignInMethod.id === 'password' ? <DefaultLoginToggle\n\t\t\t\t\t\t\t\t\t\tonlyOneLeft={onlyOneLeft}\n\t\t\t\t\t\t\t\t\t\tisEnabled={isEnabled}\n\t\t\t\t\t\t\t\t\t\tsignInMethod={signInMethod}\n\t\t\t\t\t\t\t\t\t\tonLink={this.onDefaultLoginLink}\n\t\t\t\t\t\t\t\t\t\tonUnlink={this.onUnlink}\n\t\t\t\t\t\t\t\t\t/> :\n\t\t\t\t\t\t\t\t\t<SocialLoginToggle\n\t\t\t\t\t\t\t\t\t\tonlyOneLeft={onlyOneLeft}\n\t\t\t\t\t\t\t\t\t\tisEnabled={isEnabled}\n\t\t\t\t\t\t\t\t\t\tsignInMethod={signInMethod}\n\t\t\t\t\t\t\t\t\t\tonLink={this.onSocialLoginLink}\n\t\t\t\t\t\t\t\t\t\tonUnlink={this.onUnlink}\n\t\t\t\t\t\t\t\t\t/>}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</ul>\n\t\t\t\t{error && error.message}\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nconst SocialLoginToggle = ({ onlyOneLeft, isEnabled, signInMethod, onLink, onUnlink }) =>\n\n\t\tisEnabled ? <button type=\"button\" onClick={() => onUnlink(signInMethod.id)} disabled={onlyOneLeft}>\n\t\t\tDeactivate {signInMethod.id}\n\t\t</button> :\n\t\t<button type=\"button\" onClick={() => onLink(signInMethod.provider)}>\n\t\t\tLink {signInMethod.id}\n\t\t</button>;\n\nclass DefaultLoginToggle extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = { passwordOne: '', passwordTwo: '' };\n\t}\n\n\tonSubmit = (event) => {\n\t\tevent.preventDefault();\n\n\t\tthis.props.onLink(this.state.passwordOne);\n\t\tthis.setState({ passwordOne: '', passwordTwo: '' });\n\t};\n\n\tonChange = (event) => {\n\t\tthis.setState({ [event.target.name]: event.target.value });\n\t};\n\n\trender() {\n\t\tconst { onlyOneLeft, isEnabled, signInMethod, onUnlink } = this.props;\n\n\t\tconst { passwordOne, passwordTwo } = this.state;\n\n\t\tconst isInvalid = passwordOne !== passwordTwo || passwordOne === '';\n\n\t\treturn\n\t\t\tisEnabled ? <button type=\"button\" onClick={() => onUnlink(signInMethod.id)} disabled={onlyOneLeft}>\n\t\t\t\tDeactivate {signInMethod.id}\n\t\t\t</button> :\n\t\t\t<form onSubmit={this.onSubmit}>\n\t\t\t\t<input\n\t\t\t\t\tname=\"passwordOne\"\n\t\t\t\t\tvalue={passwordOne}\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tplaceholder=\"New Password\"\n\t\t\t\t/>\n\t\t\t\t<input\n\t\t\t\t\tname=\"passwordTwo\"\n\t\t\t\t\tvalue={passwordTwo}\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\ttype=\"password\"\n\t\t\t\t\tplaceholder=\"Confirm New Password\"\n\t\t\t\t/>\n\n\t\t\t\t<button disabled={isInvalid} type=\"submit\">\n\t\t\t\t\tLink {signInMethod.id}\n\t\t\t\t</button>\n\t\t\t</form>;\n\t}\n}\n\nconst LoginManagement = withFirebase(LoginManagementBase);\n\nconst condition = (authUser) => !!authUser;\n\nexport default compose(withEmailVerification, withAuthorization(condition))(AccountPage);\n"]},"metadata":{},"sourceType":"module"}